<div class="max-w-3xl mx-auto px-6 py-12">
  <div class="mb-6">
    <%= link_to "← Library", books_path, class: "text-sm text-deep-ink/60 hover:text-deep-ink transition" %>
  </div>

  <div class="bg-white border border-deep-ink/10 p-8 md:p-12 shadow-sm rounded-sm relative overflow-hidden">
    <% if notice.present? %>
       <div class="mb-6 p-4 bg-emerald-50 text-emerald-900 rounded text-sm"><%= notice %></div>
    <% end %>

    <div class="text-center mb-8">
      <h1 class="text-4xl md:text-5xl font-bold font-serif mb-2 leading-tight"><%= @book.title %></h1>
      <p class="text-xl text-deep-ink/60 font-sans"><%= @book.author %></p>
      <div class="mt-4">
        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-deep-ink/5 text-deep-ink/70 uppercase tracking-wide">
          <%= @book.status.humanize.gsub('Dnf', 'DNF') %>
        </span>
      </div>
    </div>

    <!-- Progress -->
    <div id="progress_display" class="mb-12 max-w-lg mx-auto">
      <div class="flex justify-between text-sm font-sans mb-2 text-deep-ink/70">
        <span>Page <%= @book.current_page %></span>
        <span><%= @book.total_pages %> Pages</span>
      </div>
      <div class="w-full bg-deep-ink/5 h-2 rounded-full overflow-hidden">
        <% progress = @book.total_pages.to_i > 0 ? (@book.current_page.to_f / @book.total_pages * 100).clamp(0, 100) : 0 %>
        <div class="bg-deep-ink h-full rounded-full transition-all duration-1000 ease-out" style="width: <%= progress %>%"></div>
      </div>
      <div class="text-center mt-2 text-xs text-deep-ink/40">
        <%= progress.round %> % Complete
      </div>
    </div>

    <!-- Main Action -->
    <div id="session_controls" class="text-center mb-12">
      <% if @book.currently_reading? %>
        <%= form_with url: reading_sessions_path, method: :post, data: { turbo: true } do |f| %>
          <%= f.hidden_field :book_id, value: @book.id %>
          <%= f.button class: "group relative inline-flex items-center justify-center px-8 py-4 bg-deep-ink text-cream font-bold rounded-full overflow-hidden transition-transform active:scale-95 shadow-lg hover:shadow-xl cursor-pointer" do %>
            <span class="relative z-10 flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z" />
              </svg>
              Start Session
            </span>
          <% end %>
        <% end %>
      <% elsif @book.want_to_read? %>
         <%= button_to "Start Reading", book_path(@book, book: { status: "currently_reading", started_at: Time.current }), method: :patch, class: "px-8 py-3 bg-deep-ink text-cream font-bold rounded-sm hover:opacity-90 transition cursor-pointer" %>
      <% end %>
    </div>

    <!-- Meta / Stats Grid Placeholder -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 border-t border-deep-ink/10 pt-8 text-center">
       <div>
         <span class="block text-xs uppercase tracking-wider text-deep-ink/40 mb-1">PPM</span>
         <span class="font-mono text-lg font-bold"><%= @book.ppm %></span>
       </div>
       <div>
         <span class="block text-xs uppercase tracking-wider text-deep-ink/40 mb-1">Avg. Session</span>
         <span class="font-mono text-lg font-bold"><%= @book.average_session_duration %>m</span>
       </div>
       <div>
         <span class="block text-xs uppercase tracking-wider text-deep-ink/40 mb-1">Est. Finish</span>
         <span class="font-mono text-lg font-bold">
            <% if @book.estimated_completion_time %>
              <%= @book.estimated_completion_time %>m
            <% else %>
              —
            <% end %>
         </span>
       </div>
       <div>
         <span class="block text-xs uppercase tracking-wider text-deep-ink/40 mb-1">Started</span>
         <span class="font-mono text-sm leading-8"><%= @book.started_at&.strftime("%b %d") || "—" %></span>
       </div>
    </div>

    <!-- Edit/Delete Actions -->
    <div class="mt-12 flex justify-center gap-6 text-sm">
      <%= link_to "Edit Entry", edit_book_path(@book), class: "text-deep-ink/50 hover:text-deep-ink" %>
      <span class="text-deep-ink/20">|</span>
      <%= button_to "Remove from Library", @book, method: :delete, data: { turbo_confirm: "Are you sure?" }, class: "text-red-800/50 hover:text-red-800 bg-transparent cursor-pointer" %>
    </div>
  </div>
</div>